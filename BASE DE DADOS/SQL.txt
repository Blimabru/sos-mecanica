/* LÃ³gico: */

CREATE TABLE pessoa (
    id_pessoa INTEGER PRIMARY KEY,
    e_mail VARCHAR(50),
    cpf VARCHAR(11),
    nome_completo VARCHAR(150),
    rg VARCHAR(9),
    endereco VARCHAR(200),
    data_nascimento DATE,
    telefone_1 VARCHAR(15),
    telefone_2 VARCHAR(15),
    data_cadastro DATE,
    UNIQUE (cpf, e_mail)
);

CREATE TABLE cliente (
    id_cliente INTEGER PRIMARY KEY,
    fk_pessoa_id_pessoa INTEGER,
    fk_conta_sistema_login INTEGER,
    fk_conta_sistema_id_conta_sistema INTEGER,
    pontos INTEGER
);

CREATE TABLE colaborador (
    id_colaborador INTEGER PRIMARY KEY,
    fk_pessoa_id_pessoa INTEGER,
    fk_conta_sistema_login INTEGER,
    fk_conta_sistema_id_conta_sistema INTEGER,
    chave_pix VARCHAR(50) UNIQUE,
    conta_banco VARCHAR(30),
    data_cadastro DATE
);

CREATE TABLE conta_sistema (
    login INTEGER,
    id_conta_sistema INTEGER,
    email VARCHAR(20) UNIQUE,
    senha VARCHAR(20),
    data_cadastro DATE,
    PRIMARY KEY (login, id_conta_sistema)
);

CREATE TABLE veiculo (
    id_veiculo INTEGER PRIMARY KEY,
    fk_cliente_id_cliente INTEGER,
    placa VARCHAR(7) UNIQUE,
    ano INTEGER,
    marca VARCHAR(20),
    cor VARCHAR(15)
);

CREATE TABLE manuntencao (
    id_manutencao INTEGER PRIMARY KEY,
    fk_cliente_id_cliente INTEGER,
    fk_veiculo_id_veiculo INTEGER,
    peca VARCHAR(30),
    descricao VARCHAR(200),
    valor DECIMAL
);

CREATE TABLE trabalhos_realizados (
    fk_colaborador_id_colaborador INTEGER,
    fk_manuntencao_id_manutencao INTEGER
);
 
ALTER TABLE cliente ADD CONSTRAINT FK_cliente_2
    FOREIGN KEY (fk_pessoa_id_pessoa)
    REFERENCES pessoa (id_pessoa)
    ON DELETE CASCADE;
 
ALTER TABLE cliente ADD CONSTRAINT FK_cliente_3
    FOREIGN KEY (fk_conta_sistema_login, fk_conta_sistema_id_conta_sistema)
    REFERENCES conta_sistema (login, id_conta_sistema)
    ON DELETE CASCADE;
 
ALTER TABLE cliente ADD CONSTRAINT FK_cliente_4
    FOREIGN KEY (fk_pessoa_id_pessoa???)
    REFERENCES ??? (???);
 
ALTER TABLE colaborador ADD CONSTRAINT FK_colaborador_2
    FOREIGN KEY (fk_pessoa_id_pessoa)
    REFERENCES pessoa (id_pessoa)
    ON DELETE CASCADE;
 
ALTER TABLE colaborador ADD CONSTRAINT FK_colaborador_3
    FOREIGN KEY (fk_conta_sistema_login, fk_conta_sistema_id_conta_sistema)
    REFERENCES conta_sistema (login, id_conta_sistema)
    ON DELETE CASCADE;
 
ALTER TABLE veiculo ADD CONSTRAINT FK_veiculo_2
    FOREIGN KEY (fk_cliente_id_cliente)
    REFERENCES cliente (id_cliente)
    ON DELETE CASCADE;
 
ALTER TABLE manuntencao ADD CONSTRAINT FK_manuntencao_2
    FOREIGN KEY (fk_cliente_id_cliente)
    REFERENCES cliente (id_cliente)
    ON DELETE CASCADE;
 
ALTER TABLE manuntencao ADD CONSTRAINT FK_manuntencao_3
    FOREIGN KEY (fk_veiculo_id_veiculo)
    REFERENCES veiculo (id_veiculo)
    ON DELETE CASCADE;
 
ALTER TABLE trabalhos_realizados ADD CONSTRAINT FK_trabalhos_realizados_1
    FOREIGN KEY (fk_colaborador_id_colaborador)
    REFERENCES colaborador (id_colaborador)
    ON DELETE RESTRICT;
 
ALTER TABLE trabalhos_realizados ADD CONSTRAINT FK_trabalhos_realizados_2
    FOREIGN KEY (fk_manuntencao_id_manutencao)
    REFERENCES manuntencao (id_manutencao)
    ON DELETE SET NULL;